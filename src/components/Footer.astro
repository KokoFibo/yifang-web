---
// src/components/Footer.astro
import { Instagram, Mail, Phone } from "lucide-astro";
import { getEntry } from "astro:content";
import { getLangFromUrl } from "../i18n/utils.js"; // Import helper ini

// 1. JANGAN hanya pakai Astro.params, karena di 404 params itu kosong.
// Gunakan helper untuk deteksi bahasa dari URL sebagai cadangan.
const { lang: paramLang } = Astro.params;
const urlLang = getLangFromUrl(Astro.url);

// Pastikan lang selalu ada ('en' atau 'zh')
const lang = paramLang || urlLang || "en";

// 2. Ambil data dengan ID yang sudah pasti ada isinya
const entry = await getEntry("footer", lang);

// Jika tetap tidak ada di koleksi, berikan objek kosong agar tidak crash saat akses data.main
const data = entry?.data || {
  main: { title1: "", title2: "" },
  location: { title: "", addr1: "", addr2: "", addr3: "" },
  consultation: { title: "", telp: "", email: "" },
  touch: { title: "", telp: "", email: "" },
};

const socialLinks = [
  {
    name: "instagram",
    url: "https://instagram.com/yifang_academy",
    icon: "/images/sos-med-logos/instagram.svg",
  },
  {
    name: "tiktok",
    url: "https://tiktok.com/@yifang_academy",
    icon: "/images/sos-med-logos/tiktok.svg",
  },
  {
    name: "youtube",
    url: "https://youtube.com/@yifangacademy",
    icon: "/images/sos-med-logos/youtube.svg",
  },
  {
    name: "linkedin",
    url: "https://linkedin.com/company/yifang_investment_group",
    icon: "/images/sos-med-logos/linkedin.webp",
  },
];

const currentYear = new Date().getFullYear();
---

<div class="bg-[rgb(37,37,38)]">
  <section class="max-w-7xl mx-auto px-6 py-12 md:py-20">
    <div class="text-white border-l-4 border-primary py-2 mb-12 md:mb-20">
      <h3 class="text-3xl md:text-5xl font-bold ml-4 leading-tight">
        {data.main.title1}<br />
        {data.main.title2}
      </h3>
    </div>

    <div class="grid grid-cols-1 md:grid-cols-3 gap-12 md:gap-8 mb-16">
      <div class="flex flex-col text-white">
        <h3
          class="text-lg font-bold mb-4 text-primary uppercase tracking-widest"
        >
          {data.location.title}
        </h3>
        <div class="space-y-1 text-base md:text-lg opacity-90">
          <p class="font-bold text-xl mb-2">{data.location.addr1}</p>
          <p>{data.location.addr2}</p>
          <p>{data.location.addr3}</p>
          <p>{data.location.addr4}</p>
        </div>
      </div>

      <div class="flex flex-col text-white">
        <h3
          class="text-lg font-bold mb-4 text-primary uppercase tracking-widest"
        >
          {data.consultation.title}
        </h3>
        <div class="space-y-4">
          <a
            href={data.consultation.hreftelp}
            class="flex items-center gap-3 hover:text-primary transition-colors text-base md:text-lg group"
          >
            <div
              class="bg-gray-700 p-2 rounded group-hover:bg-primary/20 transition-colors"
            >
              <Phone size={20} class="text-primary" />
            </div>
            {data.consultation.telp}
          </a>
          <a
            href={data.consultation.hrefemail}
            class="flex items-center gap-3 hover:text-primary transition-colors text-base md:text-lg group"
          >
            <div
              class="bg-gray-700 p-2 rounded group-hover:bg-primary/20 transition-colors"
            >
              <Mail size={20} class="text-primary" />
            </div>
            {data.consultation.email}
          </a>
        </div>
      </div>

      <div class="flex flex-col text-white">
        <h3
          class="text-lg font-bold mb-4 text-primary uppercase tracking-widest"
        >
          {data.touch.title}
        </h3>
        <div class="space-y-4">
          <a
            href={data.touch.hreftelp}
            class="flex items-center gap-3 hover:text-primary transition-colors text-base md:text-lg group"
          >
            <div
              class="bg-gray-700 p-2 rounded group-hover:bg-primary/20 transition-colors"
            >
              <Phone size={20} class="text-primary" />
            </div>
            {data.touch.telp}
          </a>
          <a
            href={data.touch.hrefemail}
            class="flex items-center gap-3 hover:text-primary transition-colors text-base md:text-lg group"
          >
            <div
              class="bg-gray-700 p-2 rounded group-hover:bg-primary/20 transition-colors"
            >
              <Mail size={20} class="text-primary" />
            </div>
            {data.touch.email}
          </a>
        </div>
      </div>
    </div>

    <hr class="border-gray-700 mb-8" />

    <div class="flex flex-col md:flex-row justify-between items-center gap-8">
      <div class="flex gap-4">
        {
          socialLinks.map((social) => (
            <a
              href={social.url}
              target="_blank"
              rel="noopener noreferrer"
              class="w-10 h-10 bg-gray-600 hover:bg-primary transition-all duration-300 flex justify-center items-center rounded-sm group"
            >
              <img
                src={social.icon}
                alt={social.name}
                class="w-5 h-5 brightness-0 invert group-hover:scale-110 transition-transform"
              />
            </a>
          ))
        }
      </div>

      <p class="text-sm text-gray-500 text-center md:text-right">
        Copyright Â© {currentYear}, <span class="text-white">Yifang Group</span>.
        All rights reserved.
      </p>
    </div>
  </section>
</div>
